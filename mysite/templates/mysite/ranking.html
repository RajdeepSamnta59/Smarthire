{% extends 'mysite/base.html' %}
{% load static %}
{#
<!DOCTYPE html>#}
{#<html>#}
{#

<head>#}
    {% block link_section %}
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href={% static 'mysite/css/bootstrap.min.css' %}>
    <script src={% static 'mysite/js/jquery.min.js' %}></script>
    <script src={% static 'mysite/js/bootstrap.min.js' %}></script>
    {% endblock %}
    {#
</head>#}
{#

<body>#}

    {% block body %}
    <section class="section-hero overlay inner-page bg-image"
        style="background-image: url({% static 'mysite/images/hero_1.jpg' %});" id="home-section">
        <div class="container">
            <div class="row">
                <div class="col-md-7">
                    <h1 class="text-white font-weight-bold">Shortlisted Candidates</h1>
                    <div class="custom-breadcrumbs">
                        <a href="#">Home</a> <span class="mx-2 slash">/</span>
                        <span class="text-white"><strong>{{ company_name }}</strong></span>
                        <span class="text-white mx-2 slash"><strong>/</strong></span>
                        <span class="text-white"><strong>{{ title }}</strong></span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <section class="site-section">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2>Shortlisted Candidates: </h2>
                <a href="{% url 'export_ranking_excel' id=job_id %}" class="btn btn-success">Download Excel</a>
            </div>

            <div class="table-responsive">
                <table class="table table-striped table-bordered table-hover">
                    <thead class="thead-dark">
                        <tr>
                            <th>Rank</th>
                            <th>Name</th>
                            <th>Total Score</th>
                            <th>Skills Match</th>
                            <th>Exp (Yrs)</th>
                            <th>CGPA</th>
                            <th>College</th>
                            <th>Resume</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in items %}
                        <tr>
                            <td>{{ item.rank }}</td>
                            <td>
                                <strong>{{ item.name }}</strong><br>
                                <small class="text-muted">{{ item.email }}</small>
                            </td>
                            <td>{{ item.score|floatformat:2 }}</td>
                            <td>{{ item.skills_match|floatformat:1 }}%</td>
                            <td>{{ item.experience }}</td>
                            <td>{{ item.cgpa }}</td>
                            <td>{{ item.college }}</td>
                            <td><a href="{{ item.cv_url }}" target="_blank">View CV</a></td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="8" class="text-center">No candidates found yet.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <script>
            // Update the export link ID dynamically if needed, though usually passed in context
            // The context has 'company_name' and 'title', but maybe not the job ID directly in 'q' unless we check views.
            // In views.py: {'items': result_arr, 'company_name': job_data.company_name, 'title': job_data.title}
            // We need the job ID for the URL.
            // Let's check views.py again.
        </script>
    </section>
    {% endblock %}
    {#
</body>#}
{#

</html>#}